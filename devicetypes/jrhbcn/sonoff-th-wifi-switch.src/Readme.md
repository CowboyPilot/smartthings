Code extracted from https://github.com/erocm123/SmartThingsPublic. All credits go to it, I just added a small modification to suit my needs.
